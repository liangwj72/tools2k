"use strict";(self["webpackChunklib_java_html"]=self["webpackChunklib_java_html"]||[]).push([[748],{73492:function(t,a,e){e.d(a,{Z:function(){return h}});var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"chart-panel"},[e("canvas",{ref:"chartCanvas",attrs:{height:"228px",width:"500px"}})])},i=[],n=e(55395),s=e.n(n),o=e(98054),l={name:"bar-chart",components:{},props:{color:{type:String,required:!1,default:"#0f7ee2"},title:{type:String,required:!0},labels:{type:Array,required:!0},xdata:{type:Array,required:!0}},data:function(){return{chart:null,gradient:null,chartData:{labels:this.labels,datasets:[{label:this.title,data:this.xdata,pointRadius:2.5,borderWidth:1,borderColor:this.color}]},chartOptions:{animation:!1,showScale:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,suggestedMax:5},gridLines:{display:!1}}]},layout:{padding:0},scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}}},watch:{xdata:function(t){this.chartData.datasets[0].data=t,this.chart.update()}},mounted:function(){this.createChart()},methods:{createChart:function(){var t=this.$refs.chartCanvas,a=t.getContext("2d").createLinearGradient(0,0,0,500);a.addColorStop(0,o.Z.colorHexToRgba(this.color,.8)),a.addColorStop(1,o.Z.colorHexToRgba(this.color,.25)),this.chartData.datasets[0].backgroundColor=a,this.chart=new(s())(t,{type:"bar",data:this.chartData,options:this.chartOptions})},updateChart:function(t,a){this.chartData.datasets[0].data=a,this.chartData.labels=t,this.chart.update()}}},c=l,u=e(1001),d=(0,u.Z)(c,r,i,!1,null,null,null),h=d.exports},13748:function(t,a,e){e.r(a),e.d(a,{default:function(){return _}});var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"article-header"},[e("div",[t._v(" "+t._s(this.$route.meta.title)+" ")]),e("auto-refresh",{attrs:{fixed:!1},on:{refresh:t.reload}})],1),e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"flex-container"},[e("el-card",{staticClass:"hor-space10"},[e("el-progress",{attrs:{width:150,"stroke-width":20,type:"dashboard",percentage:t.diskInfo.percent}}),e("div",[t._v(" 硬盘空间: "),e("span",{staticClass:"text-caption"},[t._v(t._s(t.diskInfo.total))])])],1),e("br"),e("el-card",{staticClass:"full-body flex1"},[e("el-table",{attrs:{size:"mini",data:t.uriStat}},[e("el-table-column",{attrs:{label:"消耗时长"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.showUriStatDetail(a.row)}}},[t._v(" "+t._s(a.row.timeRangeMin)+" "),a.row.timeRangeMax>0?e("span",[t._v(" - "+t._s(a.row.timeRangeMax)+" ")]):t._e()])]}}])}),e("el-table-column",{attrs:{label:"次数"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.count)+" ")]}}])}),e("el-table-column",{attrs:{width:"200px",label:"占比"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-progress",{attrs:{"stroke-width":10,showText:!1,percentage:t.row.percent}})]}}])})],1)],1)],1)]),e("el-col",{attrs:{span:12}},[e("el-card",[e("bar-chart",{ref:"uriStatChart",attrs:{title:"Uri时长分布",labels:t.uriStatChart.labels,xdata:t.uriStatChart.data}})],1)],1)],1),e("br"),e("el-row",{staticClass:"mt-10",attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("line-chart",{ref:"actionChart",attrs:{chartData:t.actionChart.data,chartOptions:t.actionChart.options}})],1)],1),e("br"),e("comp-uri-detail")],1)},i=[],n=(e(41539),e(54747),e(92222),e(61874),e(9653),e(56977),e(77959)),s=e(98054),o=e(91935),l=e(90604),c=(e(42817),e(62222)),u=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("el-drawer",{attrs:{title:"详情: "+t.title,visible:t.visible,size:"50%"},on:{"update:visible":function(a){t.visible=a}}},[e("el-table",{attrs:{data:t.urlHistory}},[e("el-table-column",{attrs:{label:"url",prop:"url"}}),e("el-table-column",{attrs:{width:"180",label:"访问时间"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t._f("timeFormat")(a.row.accessTime))+" ")]}}])}),e("el-table-column",{attrs:{width:"80",label:"消耗时间"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.cost)+" ms ")]}}])})],1)],1)],1)},d=[],h=e(17190),p={name:"comp-uri-detail",components:{},props:{},data:function(){return{visible:!1,uriStat:{},title:"",urlHistory:{}}},computed:{},mounted:function(){var t=this;this.$eventBus.$off(c.Z.eventName.showUriStatDetail),this.$eventBus.$on(c.Z.eventName.showUriStatDetail,(function(a){var e=a.row;console.debug("showUriStatDetail 事件: ",e),t.visible=!0,t.uriStat=e,t.reload()}))},methods:{reload:function(){var t=this;this.uriStat.timeRangeMax>0?this.title="".concat(this.uriStat.timeRangeMin," - ").concat(this.uriStat.timeRangeMax):this.title="大于".concat(this.uriStat.timeRangeMin);var a={id:this.uriStat.id};h.Z.ajax.post(n.Z.commonRuntime.getUrlStatById,a).then((function(a){console.debug("获取uristat访问详情",a),t.urlHistory=a.stat.urlHistory}))}}},f=p,b=e(1001),m=(0,b.Z)(f,u,d,!1,null,null,null),S=m.exports,v=e(73492),g={components:{BarChart:v.Z,CompUriDetail:S,LineChart:l.Z},props:{},data:function(){return{actionChart:{data:o.Z.actionChart.data,options:o.Z.actionChart.options},uriStatChart:{labels:[],data:[]},diskInfo:{total:"",used:"",free:"",percent:1},uriStat:[]}},computed:{},activated:function(){this.reload(!1)},deactivated:function(){console.debug("activated()")},methods:{reload:function(t){var a=this;s.Z.ajax(n.Z.commonRuntime.runtimeHistory,{},(function(e){a.onDataLoad(e.list),a.updateDiskInfo(e.diskInfo),a.updateUirStat(e.uriStat),t&&s.Z.showMsg("刷新成功")}))},updateUirStat:function(t){var a=0,e=[],r=[];t.forEach((function(t){a+=t.count,t.timeRangeMax>0?e.push("".concat(t.timeRangeMin,"-").concat(t.timeRangeMax,"毫秒")):e.push("大于".concat(t.timeRangeMin)),r.push(t.count)})),this.$refs.uriStatChart.updateChart(e,r),t.forEach((function(t){t.percent=a>0?s.Z.percent2num(100*t.count/a):0})),this.uriStat=t,console.debug("uri访问时长段统计:",this.uriStatChart)},updateDiskInfo:function(t){var a=t.totalSpace-t.usableSpace;t.totalSpace>0?this.diskInfo.percent=Number.parseFloat((100*a/t.totalSpace).toFixed(2)):this.diskInfo.percent=0,this.diskInfo.total=s.Z.toSizeStr(t.totalSpace),this.diskInfo.used=s.Z.toSizeStr(a),this.diskInfo.free=s.Z.toSizeStr(t.usableSpace)},onDataLoad:function(t){o.Z.onDataLoad(t),this.$refs.actionChart.updateChart()},showUriStatDetail:function(t){console.debug("查看uri时长统计详情:id=".concat(t.id)),c.Z.showUriStatDetail(t)}}},C=g,w=(0,b.Z)(C,r,i,!1,null,null,null),_=w.exports}}]);