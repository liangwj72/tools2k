"use strict";(self["webpackChunklib_java_html"]=self["webpackChunklib_java_html"]||[]).push([[752],{90604:function(a,t,e){e.d(t,{Z:function(){return u}});var s=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"chart-panel"},[e("canvas",{ref:"chartCanvas",attrs:{height:"150px"}}),a.showAvg?e("div",{staticClass:"down-txt"},[a._v("平均值: "+a._s(a.avg)+" "+a._s(a.avgPostFix)+"/ 秒")]):a._e()])},o=[],r=e(55395),d=e.n(r),i=e(91935),n={name:"line-chart",components:{},props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,required:!0},showAvg:{type:Boolean,default:!1},avgPostFix:{type:String,default:""},scales:{type:Number,default:1}},data(){return{chart:null,avg:0}},mounted(){this.createChart()},methods:{createChart(){let a=this.$refs.chartCanvas;this.chart=new(d())(a,{type:"line",data:this.chartData,options:this.chartOptions})},updateChart(){if(this.chart.update(),this.showAvg){let a=this.chartData.datasets,t=0;a&&a.length>0&&a[0].data.forEach((a=>{t+=parseFloat(a)*this.scales}));let e=i.Z.timeDiff;this.avg=e&&e>0?(t/e).toFixed(2):0}}}},l=n,h=e(1001),c=(0,h.Z)(l,s,o,!1,null,null,null),u=c.exports},87752:function(a,t,e){e.r(t),e.d(t,{default:function(){return C}});var s=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("div",{staticClass:"article-header"},[e("div",[a._v(" "+a._s(this.$route.meta.title)+" ")]),e("auto-refresh",{attrs:{fixed:!1},on:{refresh:a.reload}})],1),e("el-row",{staticClass:"mt-10",attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("line-chart",{ref:"memoryChart",attrs:{chartData:a.memoryChart.data,chartOptions:a.memoryChart.options}})],1),e("el-col",{attrs:{span:12}},[e("line-chart",{ref:"cpuChart",attrs:{chartData:a.cpuChart.data,chartOptions:a.cpuChart.options}})],1)],1),e("br"),a.hasSendPacketData?[e("el-row",{staticClass:"mt-10",attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("line-chart",{ref:"sendPacketCountChart",attrs:{"avg-post-fix":"个 ","show-avg":!0,chartData:a.sendPacketCountChart.data,chartOptions:a.sendPacketCountChart.options}})],1),e("el-col",{attrs:{span:12}},[e("line-chart",{ref:"sendPacketPayloadChart",attrs:{"avg-post-fix":"KB ",scales:10,"show-avg":!0,chartData:a.sendPacketPayloadChart.data,chartOptions:a.sendPacketPayloadChart.options}})],1)],1),e("br")]:a._e(),e("el-row",{staticClass:"mt-10",attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("line-chart",{ref:"threadChart",attrs:{chartData:a.threadChart.data,chartOptions:a.threadChart.options}})],1)],1),e("br"),a.hasWsApiImpl?e("el-row",{staticClass:"mt-10",attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("line-chart",{ref:"wsCountChart",attrs:{chartData:a.wsCountChart.data,chartOptions:a.wsCountChart.options}})],1),e("el-col",{attrs:{span:12}},[e("line-chart",{ref:"wsPayloadChart",attrs:{chartData:a.wsPayloadChart.data,chartOptions:a.wsPayloadChart.options}})],1)],1):a._e()],2)},o=[],r=e(25787),d=e(98054),i=e(91935),n=e(90604),l=e(42817),h={components:{LineChart:n.Z},props:{},data(){return{hasWsApiImpl:l.Z.serverInfo.hasWsApiImpl,hasSendPacketData:l.Z.serverInfo.hasSendPacketData,memoryChart:{data:i.Z.memoryChart.data,options:i.Z.memoryChart.options},cpuChart:{data:i.Z.cpuChart.data,options:i.Z.cpuChart.options},threadChart:{data:i.Z.threadChart.data,options:i.Z.threadChart.options},wsCountChart:{data:i.Z.wsCountChart.data,options:i.Z.wsCountChart.options},wsPayloadChart:{data:i.Z.wsPayloadChart.data,options:i.Z.wsPayloadChart.options},sendPacketCountChart:{data:i.Z.sendPacketCountChart.data,options:i.Z.sendPacketCountChart.options},sendPacketPayloadChart:{data:i.Z.sendPacketPayloadChart.data,options:i.Z.sendPacketPayloadChart.options}}},computed:{},activated(){this.reload(!1)},deactivated(){console.debug("activated()")},methods:{reload(a){const t=this;d.Z.ajax(r.Z.commonRuntime.runtimeHistory,{},(function(e){t.onDataLoad(e.list),a&&d.Z.showMsg("刷新成功")}))},onDataLoad(a){i.Z.onDataLoad(a),this.hasWsApiImpl&&(this.$refs.wsCountChart.updateChart(),this.$refs.wsPayloadChart.updateChart()),this.hasSendPacketData&&(this.$refs.sendPacketCountChart.updateChart(),this.$refs.sendPacketPayloadChart.updateChart()),this.$refs.threadChart.updateChart(),this.$refs.cpuChart.updateChart(),this.$refs.memoryChart.updateChart()}}},c=h,u=e(1001),p=(0,u.Z)(c,s,o,!1,null,null,null),C=p.exports},91935:function(a,t,e){e.d(t,{Z:function(){return g}});const s={memory:{total:"#5CB85C",used:"#5BC0DE"},cpu:{jvm:"#9418de"},thread:"#E6A23C",action:"#77e0c0",wsCount:{color0:"#e2cb15",color1:"#0f7ee2"},sendPacket:{count:"#574ed2",payload:"#2053ea"}};var o=s,r=e(98054),d={data:{labels:[],datasets:[{label:"已分配内存",fill:"1",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.memory.total,backgroundColor:r.Z.colorHexToRgba(o.memory.total,.4)},{label:"已经使用的内存",fill:"origin",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.memory.used,backgroundColor:r.Z.colorHexToRgba(o.memory.used,.5)}]},options:{animation:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,callback:function(a){return a+" MB"}},gridLines:{display:!1}}]},layout:{padding:15},title:{display:!0,text:"内存"},showLines:!0,scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}},i={data:{labels:[],datasets:[{label:"JVM负载",fill:"origin",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.cpu.jvm,backgroundColor:r.Z.colorHexToRgba(o.cpu.jvm,.4)}]},options:{animation:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,callback:function(a){return a.toFixed(0)+"%"},suggestedMax:100,suggestedMin:0},gridLines:{display:!0}}]},layout:{padding:15},title:{display:!0,text:"CPU使用情况"},showLines:!0,scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}},n={data:{labels:[],datasets:[{label:"活动线程数",fill:"origin",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.thread,backgroundColor:r.Z.colorHexToRgba(o.thread,.4)}]},options:{animation:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,suggestedMax:100},gridLines:{display:!1}}]},layout:{padding:15},title:{display:!0,text:"线程"},showLines:!0,scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}},l={data:{labels:[],datasets:[{label:"HTTP动态请求数",fill:"origin",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.action,backgroundColor:r.Z.colorHexToRgba(o.action,.4)}]},options:{animation:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,suggestedMax:10},gridLines:{display:!1}}]},layout:{padding:5},title:{display:!0,text:"HTTP动态请求数"},showLines:!0,scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}},h={data:{labels:[],datasets:[{label:"接收请求数",fill:"false",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.wsCount.color0,backgroundColor:r.Z.colorHexToRgba(o.wsCount.color0,.4)},{label:"发送消息数",fill:"false",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.wsCount.color1,backgroundColor:r.Z.colorHexToRgba(o.wsCount.color1,.4)}]},options:{animation:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,suggestedMax:10},gridLines:{display:!1}}]},layout:{padding:15},title:{display:!0,text:"Web socket API 接收/发送 次数"},showLines:!0,scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}},c={data:{labels:[],datasets:[{label:"接收请求流量",fill:"false",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.wsCount.color0,backgroundColor:r.Z.colorHexToRgba(o.wsCount.color0,.4)},{label:"发送消息流量",fill:"false",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.wsCount.color1,backgroundColor:r.Z.colorHexToRgba(o.wsCount.color1,.4)}]},options:{animation:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,suggestedMax:10,callback:function(a){return a+" K"}},gridLines:{display:!1}}]},layout:{padding:5},title:{display:!0,text:"Web socket API 流量"},showLines:!0,scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}},u={data:{labels:["0-1毫秒","1-10毫秒","10-100毫秒","100-1000毫秒","1-10秒次数","10-100秒","100-1000秒","大于1000秒"],datasets:[{label:"sql执行时间",data:[0,0,0,2,0,0,0,0],pointRadius:2.5,borderWidth:1,borderColor:o.action,backgroundColor:r.Z.colorHexToRgba(o.action,.4)}]},options:{animation:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,suggestedMax:100},gridLines:{display:!1}}]},layout:{padding:5},showLines:!0,scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}},p={data:{labels:[],timeDiff:0,datasets:[{label:"10秒发包数量",fill:"origin",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.sendPacket.count,backgroundColor:r.Z.colorHexToRgba(o.sendPacket.count,.4)}]},options:{animation:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,suggestedMax:10},gridLines:{display:!1}}]},layout:{padding:5},title:{display:!0,text:"10秒发包数量"},showLines:!0,scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}},C={data:{labels:[],datasets:[{label:"10秒平均流量",fill:"origin",data:[],pointRadius:2.5,borderWidth:1,borderColor:o.sendPacket.payload,backgroundColor:r.Z.colorHexToRgba(o.sendPacket.payload,.4)}]},options:{animation:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,callback:function(a){return a+" KB/s"}},gridLines:{display:!1}}]},layout:{padding:5},title:{display:!0,text:"10秒平均流量"},showLines:!0,scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}},b=e(42817),g={sendPacketCountChart:p,sendPacketPayloadChart:C,avgSendPacketCount:0,avgSendPacketPayload:0,memoryChart:d,cpuChart:i,threadChart:n,actionChart:l,wsCountChart:h,wsPayloadChart:c,sqlTimeChart:u,timeDiff:0,onDataLoad(a){const t=[],e=[],s=[],o=[],d=[],i=[],n=[],l=[],h=[],c=[],u=[],p=[];let C=0,g=0;for(let b of a){let a=b.recordTime;(0===C||C>a)&&(C=a),g<a&&(g=a),this.timeDiff=g-C>0?(g-C)/1e3+10:0,t.push(r.Z.timeFormat(a,"hh:mm:ss")),e.push(r.Z.toMemoryM(b.memory.totalMemory)),s.push(r.Z.toMemoryM(b.memory.usedMemory)),o.push(Math.round(100*b.processCpuLoad)/100),d.push(b.threadCount),i.push(b.actionCount),n.push(b.wsUpCount),l.push(b.wsUpCount),h.push(r.Z.sizeToK(b.wsUpPayload)),c.push(r.Z.sizeToK(b.wsDownPayload)),u.push(b.sendPacketCount),p.push(r.Z.sizeToK(b.sendPacketPayload/10))}this.updateMemoryChart(t,e,s),this.updateCpuChart(t,o),this.updateThreadChart(t,d),this.updateActionChart(t,i),b.Z.serverInfo.hasWsApiImpl&&(this.updateWsCountChart(t,n,l),this.updateWsPayloadChart(t,h,c)),b.Z.serverInfo.hasSendPacketData&&(this.updateSendPacketCountChart(t,u),this.updateSendPacketPayloadChart(t,p))},updateWsCountChart(a,t,e){const s=this.wsCountChart.data;s.datasets[0].data=t,s.datasets[1].data=e,s.labels=a},updateWsPayloadChart(a,t,e){const s=this.wsPayloadChart.data;s.datasets[0].data=t,s.datasets[1].data=e,s.labels=a},updateActionChart(a,t){const e=this.actionChart.data;e.datasets[0].data=t,e.labels=a},updateSendPacketCountChart(a,t){const e=this.sendPacketCountChart.data;e.datasets[0].data=t,e.labels=a},updateSendPacketPayloadChart(a,t){const e=this.sendPacketPayloadChart.data;e.datasets[0].data=t,e.labels=a},updateThreadChart(a,t){const e=this.threadChart.data;e.datasets[0].data=t,e.labels=a},updateCpuChart(a,t){const e=this.cpuChart.data;e.datasets[0].data=t,e.labels=a},updateMemoryChart(a,t,e){const s=this.memoryChart.data;s.datasets[0].data=t,s.datasets[1].data=e,s.labels=a}}}}]);