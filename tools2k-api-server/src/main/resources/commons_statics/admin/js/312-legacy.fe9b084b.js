"use strict";(self["webpackChunklib_java_html"]=self["webpackChunklib_java_html"]||[]).push([[312],{73492:function(t,e,a){a.d(e,{Z:function(){return f}});var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chart-panel"},[a("canvas",{ref:"chartCanvas",attrs:{height:"228px",width:"500px"}})])},s=[],i=a(55395),r=a.n(i),o=a(98054),n={name:"bar-chart",components:{},props:{color:{type:String,required:!1,default:"#0f7ee2"},title:{type:String,required:!0},labels:{type:Array,required:!0},xdata:{type:Array,required:!0}},data:function(){return{chart:null,gradient:null,chartData:{labels:this.labels,datasets:[{label:this.title,data:this.xdata,pointRadius:2.5,borderWidth:1,borderColor:this.color}]},chartOptions:{animation:!1,showScale:!1,scales:{yAxes:[{ticks:{beginAtZero:!0,suggestedMax:5},gridLines:{display:!1}}]},layout:{padding:0},scaleGridLineWidth:2,scaleShowGridLines:!1,scaleShowLabels:!1,datasetStrokeWidth:2,responsive:!0}}},watch:{xdata:function(t){this.chartData.datasets[0].data=t,this.chart.update()}},mounted:function(){this.createChart()},methods:{createChart:function(){var t=this.$refs.chartCanvas,e=t.getContext("2d").createLinearGradient(0,0,0,500);e.addColorStop(0,o.Z.colorHexToRgba(this.color,.8)),e.addColorStop(1,o.Z.colorHexToRgba(this.color,.25)),this.chartData.datasets[0].backgroundColor=e,this.chart=new(r())(t,{type:"bar",data:this.chartData,options:this.chartOptions})},updateChart:function(t,e){this.chartData.datasets[0].data=e,this.chartData.labels=t,this.chart.update()}}},c=n,d=a(1001),u=(0,d.Z)(c,l,s,!1,null,null,null),f=u.exports},92144:function(t,e,a){a.d(e,{Z:function(){return u}});var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-popconfirm",{attrs:{title:"确定重置计数器吗？"},on:{confirm:t.resetAll}},[a("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("重置计数器")])],1)},s=[],i=a(77959),r=a(17190),o={name:"CompResetDruid",methods:{resetAll:function(){var t=this;console.debug("点击了重置计数器按钮"),r.Z.ajax.post(i.Z.commonDurid.resetAll,{}).then((function(){t.$emit("refresh")}))}}},n=o,c=a(1001),d=(0,c.Z)(n,l,s,!1,null,null,null),u=d.exports},25312:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"article-header"},[a("div",[t._v(" "+t._s(this.$route.meta.title)+" ")]),a("comp-reset-druid",{on:{refresh:t.reload}}),a("auto-refresh",{attrs:{fixed:!1,timer:!1},on:{refresh:t.reload}})],1),a("div",{staticClass:"article-container"},[a("el-table",{attrs:{border:"",size:"small",data:t.uriList}},[a("el-table-column",{attrs:{sortable:"",prop:"URI","show-overflow-tooltip":!0,label:"URI"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.viewDetail(e.row)}}},[t._v(" "+t._s(e.row.URI)+" ")])]}}])}),a("el-table-column",{attrs:{label:"sql执行数",sortable:"",align:"right",width:"110px",prop:"JdbcExecuteCount"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("noZero")(e.row.JdbcExecuteCount))+" ")]}}])}),a("el-table-column",{attrs:{label:"请求次数",sortable:"",align:"right",width:"105px",prop:"RequestCount"}}),a("el-table-column",{attrs:{label:"合计时长",sortable:"",align:"right",width:"105px",prop:"RequestTimeMillis"}}),a("el-table-column",{attrs:{label:"请求最慢",sortable:"",align:"right",width:"105px",prop:"RequestTimeMillisMax"}}),a("el-table-column",{attrs:{sortable:"",align:"right",width:"180px",label:"最后访问"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("timeFormat")(e.row.RequestTimeMillisMaxOccurTime))+" ")]}}])})],1)],1),a("el-drawer",{attrs:{title:"详情",visible:t.detail.visible,size:"900px"},on:{"update:visible":function(e){return t.$set(t.detail,"visible",e)}}},[a("el-card",{staticClass:"article-small-card"},[a("el-form",{attrs:{labelPosition:"left","label-width":"150px"}},[a("el-form-item",{staticClass:"text-caption",attrs:{label:"URL:"}},[t._v(" "+t._s(t.detail.data.URI)+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"请求次数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.RequestCount))+" "),a("bar-chart",{attrs:{title:"时长分布",labels:t.timeChart.labels,xdata:t.timeChart.data}})],1),a("el-form-item",{staticClass:"text-caption",attrs:{label:"合计时长:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.RequestTimeMillis))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"请求最慢:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.RequestTimeMillisMax))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"最后访问时间:"}},[t._v(" "+t._s(t._f("timeFormat")(t.detail.data.LastAccessTime))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"执行中:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.RunningCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"最大并发:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.ConcurrentMax))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"Sql执行数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcExecuteCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"Sql出错数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.ErrorCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"Sql执行峰值:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcExecutePeak))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"Sql时间:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcExecuteTimeMillis))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"事务提交数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcCommitCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"事务回滚数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcRollbackCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"Sql查询取回行数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcFetchRowCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"Sql查询取回行数峰值:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcFetchRowPeak))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"Sql更新行数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcUpdateCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"Sql更新峰值:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcUpdatePeak))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"连接池获取连接次数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcPoolConnectionOpenCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"连接池关闭连接次数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcPoolConnectionCloseCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"ResultSet打开次数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcResultSetOpenCount))+" ")]),a("el-form-item",{staticClass:"text-caption",attrs:{label:"ResultSet关闭次数:"}},[t._v(" "+t._s(t._f("noZero")(t.detail.data.JdbcResultSetCloseCount))+" ")])],1)],1)],1)],1)},s=[],i=a(77959),r=a(17190),o=a(73492),n=a(92144),c={components:{CompResetDruid:n.Z,BarChart:o.Z},props:{},data:function(){return{uriList:[],timeChart:{color:"#5BC0DE",data:[],labels:["0-1毫秒次数","1-10毫秒次数","10-100毫秒次数","100-1000毫秒次数","1-10秒次数","10-100秒次数","100-1000秒次数","大于1000秒次数"]},detail:{visible:!1,data:[]}}},computed:{},mounted:function(){},activated:function(){this.reload()},methods:{reload:function(){var t=this;r.Z.ajax.post(i.Z.commonDurid.getWebUris,{}).then((function(e){t.uriList=e.list}))},resetAll:function(){var t=this;console.debug("点击了重置计数器按钮"),r.Z.ajax.post(i.Z.commonDurid.resetAll,{}).then((function(){t.reload()}))},viewDetail:function(t){this.detail.data=t,this.detail.visible=!0,this.timeChart.data=t.Histogram}}},d=c,u=a(1001),f=(0,u.Z)(d,l,s,!1,null,null,null),m=f.exports}}]);